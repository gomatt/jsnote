<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>jsnote</title>
    <script id="data">
      var data = {
        "home": {
          "content": "Welcome to [[jsnote]]! You are currently viewing {{page.type}} [[{{page.path}}]]."
        },
        "system:template:default": {
          "content": "<div id=\"header\">{{page.path}}</div><br /><div id=\"page_content\">{{page.content}}</div>"
        }
      };
    </script>
    <script id="config">
      // Configuration array
      var config = {
        version: "0.1a",
        current: "",
        delimiter: ":",
        action: "::",
        template: "system:template:default",
        home: "home"
      };
    </script>
    <script id="core">
      (function() {
        function addListener(obj, event, listener) {
          /* Add event listener based on browser version */
          if (obj.addEventListener) {
            /* All browsers (however at least Opera 7, IE 9) */
            obj.addEventListener(event, listener, false);
          } else {
            /* Opera 6, IE 8 and earlier */
            obj.attachEvent("on" + event, listener);
          }
        }
        function handleDCL(e) {
          console.log("DOMContentLoaded event fired.");
          init();
        }
        function handleOnLoad(e) {
          console.log("OnLoad event fired.");
        }
        function defaultValue(arg, val) {
          return typeof arg !== 'undefined' ? arg : val;
        }
        function exist(path) {
          // Return boolean - existance of path provided
          return Object.prototype.toString.call(data[path]) === "[object Object]"; /* global data */
        }
        function get(path, member) {
          member = defaultValue(member, 'content');
          if (exist(path)) {
            return data[path][member];
          }
        }
        function collection() {
          // initialize a blank array
          this.pages = [];
        }
        collection.prototype = {
      		index: function(path) {
      		  // Return the index number for a specific path string
      		  // The index number is required for the collection array
      			for (var i = 0; i < this.pages.length; ++i) {
      				if (this.pages[i].path === path) {
      					return i;
      				}
      			}
      			return false;
      		},
          import: function(path) {
            // Add the page to the collection if it exists in data
            // What happens if it already exists in the collection?
            if (exist(path)) {
              // Add the new page object to the collection
              this.pages.push(new page(path, this));
            }
          },
          page: function(path) {
      			try {
      				return this.pages[this.index(path)];
      			}
      			catch(e) {
      				console.log(e.message);
      				return false;
      			}
          }
        };
        function page(path, collection) {
          this.path = path;
          for (var key in data[path]) {
            this[key] = data[path][key];
          }
          this.original = data[path];
          this.collection = collection;
          
          // Now create HTML automatically
          //this.expand();
          //this.parse();
        }
        page.prototype = {

        };
        function load(path) {
          var Collection = new collection();
          Collection.import(path);
          console.log(Collection);
          console.log(Collection.page(path));
          //document.body.innerHTML = Collection.pages[path].html;
        }
        function init() {
          load(config.home); /* global config */
        }
        
        if (!window.addEventListener) {
          console.log("Can't add eventListeners; not supported.");
        } else {
          addListener(document, "DOMContentLoaded", handleDCL);
          addListener(window, "load", handleOnLoad);
        }
      })(this);
    </script>
  </head>
  <body>
  </body>
</html>